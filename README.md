# Automated Redemption Manager (ARM) for Origin ETH (OETH)

Swap OETH for WETH at 1:1 ratio.

## Development

### Install

```
foundryup
forge install
forge compile
```

### Running tests


### Running gas report scripts

## Open Zeppelin Defender

[Open Zeppelin Defender v2](https://docs.openzeppelin.com/defender/v2/) is used to manage the Operations account and automate AMM operational jobs like managing liquidity.


### Deploying Defender Autotasks

Autotasks are used to run operational jobs are specific times or intervals.

[rollup](https://rollupjs.org/) is used to bundle the Autotask source code in [/src/js/autotasks](./src/js/autotasks) into a single file that can be uploaded to Defender. The implementation was based off [Defender Autotask example using Rollup](https://github.com/OpenZeppelin/defender-autotask-examples/tree/master/rollup). The rollup config is in [/src/js/autotasks/rollup.config.cjs](./src/js/autotasks/rollup.config.cjs). The outputs are written to task-specific folders under [/src/js/autotasks/dist](./src/js/autotasks/dist/).

The [defender-autotask CLI](https://www.npmjs.com/package/@openzeppelin/defender-autotask-client) is used to upload the Action code to Defender.
For this to work, a Defender Team API key with `Manage Actions` capabilities is needed. This can be generated by a Defender team admin under the `Manage` tab on the top right of the UI and then `API Keys` on the left menu.

The following will set the Defender Team API key and bundle the Autotask code ready for upload.

```
cd ./src/js/autotasks

# Export the Defender Team API key. This is different to the Defender Relayer API key.
export API_KEY=
export API_SECRET=

npx rollup -c
```

The following will upload the different Autotask bundles to Defender.

```
# autoRequestWithdraw

# autoClaimWithdraws

```

`rollup` and `defender-autotask` can be installed globally to avoid the `npx` prefix.

